---
tosca_definitions_version: tosca_simple_yaml_1_3

description: Service Template for deploying remote LED service in swarm

imports:
  - nodetypes/swarm/swarm.yaml
  - nodetypes/webserver_container/webserver_container.yaml
  - nodetypes/websocket_container/websocket_container.yaml
  - nodetypes/actuation_service/actuation_service.yaml

metadata:
  template_name: "docker"
  template_author: "UoH"
  template_version: "1.0"

topology_template:
  inputs:
    host_ip:
      type: string
      
    manager:
      type: list
      default: []
    workers:
      type: list
      default: []

    sensor_nodes:
      type: list
      default: []

  node_templates:
    my-workstation:
      type: tosca.nodes.Compute
      attributes:
        private_address: { get_input: host_ip }
        public_address: { get_input: host_ip }

    docker-swarm:
      type: radon.nodes.DockerSwarm
      requirements:
        - host: my-workstation

    websocket:
      type: radon.nodes.WebsocketContainer
      requirements:
        - host: docker-swarm

    web-server:
      type: radon.nodes.WebserverContainer
      requirements:
        - host: docker-swarm

    led-service:
      type: radon.nodes.ActuationService
      requirements:
        - host: websocket
...